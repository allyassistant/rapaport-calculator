<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Show Stock Check V5</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        :root {
            /* ‰∏≠ÊÄßÁÅ∞ÁôΩÈÖçËâ≤ */
            --white: #FFFFFF;
            --gray-50: #F9FAFB;
            --gray-100: #F3F4F6;
            --gray-200: #E5E7EB;
            --gray-300: #D1D5DB;
            --gray-400: #9CA3AF;
            --gray-500: #6B7280;
            --gray-600: #4B5563;
            --gray-700: #374151;
            --gray-800: #1F2937;
            --gray-900: #111827;
            
            /* Âº∑Ë™øËâ≤ - ‰∏≠ÊÄßËóçÁÅ∞ */
            --accent: #64748B;
            --accent-light: #94A3B8;
            --accent-dark: #475569;
            
            /* ÁãÄÊÖãËâ≤ - ÊüîÂíåÁâà */
            --green: #10B981;
            --green-soft: #D1FAE5;
            --yellow: #F59E0B;
            --yellow-soft: #FEF3C7;
            --blue: #3B82F6;
            --blue-soft: #DBEAFE;
            --red: #EF4444;
            --red-soft: #FEE2E2;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'SF Pro Text', 'Helvetica Neue', sans-serif;
            background: linear-gradient(180deg, #F8FAFC 0%, #F1F5F9 100%);
            color: var(--gray-800);
            min-height: 100vh;
            padding-bottom: 80px;
            -webkit-font-smoothing: antialiased;
        }
        
        /* ===== Liquid Glass ÊïàÊûú ===== */
        .glass {
            background: rgba(255, 255, 255, 0.72);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.65);
            backdrop-filter: blur(16px) saturate(160%);
            -webkit-backdrop-filter: blur(16px) saturate(160%);
            border: 1px solid rgba(255, 255, 255, 0.6);
            box-shadow: 
                0 1px 2px rgba(0, 0, 0, 0.02),
                0 4px 8px rgba(0, 0, 0, 0.04),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
        }
        
        .glass-dark {
            background: rgba(15, 23, 42, 0.75);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* ===== Toast ÈÄöÁü• ===== */
        .toast-container {
            position: fixed;
            top: 60px;
            left: 16px;
            right: 16px;
            z-index: 1000;
            pointer-events: none;
        }
        
        .toast {
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 12px;
            padding: 14px 18px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
            transform: translateY(-20px);
            opacity: 0;
            transition: all 0.35s cubic-bezier(0.16, 1, 0.3, 1);
        }
        
        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        .toast-icon {
            font-size: 20px;
            flex-shrink: 0;
        }
        
        .toast-content {
            flex: 1;
        }
        
        .toast-title {
            font-size: 15px;
            font-weight: 600;
            color: var(--white);
            margin-bottom: 2px;
        }
        
        .toast-message {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .toast-close {
            font-size: 18px;
            color: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            padding: 4px;
        }
        
        /* ===== È†ÅÈù¢ÁµêÊßã ===== */
        .tab-page {
            display: none;
            padding: 16px;
            max-width: 480px;
            margin: 0 auto;
            padding-bottom: 100px;
        }
        
        .tab-page.active { display: block; }
        
        /* ===== È†ÇÈÉ®Ê®ôÈ°åÂçÄ ===== */
        .header {
            position: sticky;
            top: 0;
            z-index: 50;
            padding: 16px;
            margin: -16px -16px 20px -16px;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        h1 {
            font-size: 28px;
            font-weight: 700;
            color: var(--gray-900);
            letter-spacing: -0.02em;
        }
        
        .last-update {
            font-size: 12px;
            color: var(--gray-500);
            margin-top: 4px;
        }
        
        h2 {
            font-size: 20px;
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .back-btn {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: var(--gray-700);
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        
        .back-btn:active { transform: scale(0.95); background: rgba(255, 255, 255, 0.8); }
        
        /* ===== Import ÂçÄÂüü ===== */
        .import-section {
            border-radius: 16px;
            padding: 40px 24px;
            text-align: center;
            margin-bottom: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .import-section:hover {
            background: rgba(255, 255, 255, 0.8);
            transform: translateY(-1px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.06);
        }
        
        .import-section:active { transform: translateY(0); }
        
        .import-icon { 
            font-size: 44px; 
            margin-bottom: 12px;
            opacity: 0.9;
        }
        
        .import-text { 
            font-size: 16px; 
            font-weight: 600;
            color: var(--gray-800); 
            margin-bottom: 6px;
        }
        
        .import-hint { 
            font-size: 13px; 
            color: var(--gray-500); 
        }
        
        /* ===== Shape Grid ===== */
        .shape-grid { display: grid; gap: 10px; }
        
        .shape-card {
            border-radius: 16px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.25s cubic-bezier(0.16, 1, 0.3, 1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .shape-card:hover {
            transform: translateY(-1px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
            background: rgba(255, 255, 255, 0.8);
        }
        
        .shape-card:active { transform: scale(0.98); }
        
        .shape-info h3 {
            font-size: 17px;
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 4px;
            letter-spacing: -0.01em;
        }
        
        .shape-info p { 
            font-size: 14px; 
            color: var(--gray-500); 
        }
        
        .shape-arrow { 
            font-size: 22px; 
            color: var(--gray-400);
            opacity: 0.6;
        }
        
        /* ===== ÈëΩÁü≥Âç°Áâá ===== */
        .diamond-list { display: flex; flex-direction: column; gap: 10px; }
        
        .diamond-card {
            border-radius: 16px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
            -webkit-user-select: none;
        }
        
        .diamond-card:active { transform: scale(0.985); }
        
        /* Êú™ÈÅ∏ÁãÄÊÖã */
        .diamond-card.unchecked {
            background: rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.6);
        }
        
        /* Á∂†Ëâ≤ÈÅ∏Âèñ */
        .diamond-card.selected-green {
            background: var(--green-soft);
            border: 1.5px solid var(--green);
        }
        
        .diamond-card.selected-green .diamond-title,
        .diamond-card.selected-green .diamond-price {
            color: var(--green);
        }
        
        /* ÈªÉËâ≤ÈÅ∏Âèñ */
        .diamond-card.selected-yellow {
            background: var(--yellow-soft);
            border: 1.5px solid var(--yellow);
        }
        
        .diamond-card.selected-yellow .diamond-title,
        .diamond-card.selected-yellow .diamond-price {
            color: var(--yellow);
        }
        
        /* ËóçËâ≤ÈÅ∏Âèñ */
        .diamond-card.selected-blue {
            background: var(--blue-soft);
            border: 1.5px solid var(--blue);
        }
        
        .diamond-card.selected-blue .diamond-title,
        .diamond-card.selected-blue .diamond-price {
            color: var(--blue);
        }
        
        .diamond-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }
        
        .diamond-title {
            font-size: 17px;
            font-weight: 600;
            color: var(--gray-800);
            transition: color 0.2s;
            letter-spacing: -0.01em;
        }
        
        .diamond-price {
            font-size: 16px;
            font-weight: 600;
            color: var(--gray-700);
            transition: color 0.2s;
        }
        
        .diamond-specs {
            display: flex;
            gap: 10px;
            margin-bottom: 8px;
            flex-wrap: wrap;
        }
        
        .spec-tag {
            font-size: 14px;
            color: var(--gray-500);
            transition: color 0.2s;
        }
        
        .spec-tag:not(:last-child)::after {
            content: "¬∑";
            margin-left: 10px;
            color: var(--gray-300);
        }
        
        .diamond-cert { 
            font-size: 12px; 
            color: var(--gray-400);
            font-family: 'SF Mono', monospace;
            letter-spacing: 0.02em;
        }
        
        /* ===== ÁãÄÊÖãÊ®ôÁ±§ ===== */
        .status-badge {
            display: inline-block;
            font-size: 10px;
            font-weight: 600;
            padding: 3px 10px;
            border-radius: 20px;
            margin-left: 8px;
            text-transform: uppercase;
            letter-spacing: 0.02em;
        }
        
        .status-badge.green {
            background: var(--green);
            color: var(--white);
        }
        
        .status-badge.yellow {
            background: var(--yellow);
            color: var(--white);
        }
        
        .status-badge.blue {
            background: var(--blue);
            color: var(--white);
        }
        
        /* ===== Submit Ê¨Ñ ===== */
        .submit-bar {
            position: fixed;
            bottom: 84px;
            left: 12px;
            right: 12px;
            border-radius: 16px;
            padding: 12px 16px;
            display: flex;
            gap: 12px;
            align-items: center;
            z-index: 50;
        }
        
        .submit-info {
            flex: 1;
            font-size: 14px;
            color: var(--gray-600);
        }
        
        .submit-info span {
            font-weight: 700;
            color: var(--green);
        }
        
        .btn {
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
        }
        
        .btn-primary {
            background: var(--gray-800);
            color: var(--white);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12);
        }
        
        .btn-primary:hover { 
            background: var(--gray-900);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.6);
            color: var(--gray-600);
            border: 1px solid rgba(0, 0, 0, 0.08);
        }
        
        .btn-secondary:hover { background: rgba(255, 255, 255, 0.9); }
        
        /* ===== Â∫ïÈÉ® Tab Â∞éËà™ (Liquid Glass) ===== */
        .tab-bar {
            position: fixed;
            bottom: 12px;
            left: 12px;
            right: 12px;
            border-radius: 20px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            height: 64px;
            z-index: 100;
            padding-bottom: env(safe-area-inset-bottom, 0);
        }
        
        .tab-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            cursor: pointer;
            transition: all 0.2s;
            gap: 4px;
            border-radius: 12px;
            margin: 6px;
        }
        
        .tab-item:active { background: rgba(0, 0, 0, 0.04); }
        
        .tab-icon {
            font-size: 22px;
            color: var(--gray-400);
            transition: all 0.2s;
        }
        
        .tab-label {
            font-size: 10px;
            color: var(--gray-500);
            font-weight: 500;
            transition: all 0.2s;
        }
        
        .tab-item.active .tab-icon { color: var(--gray-800); }
        .tab-item.active .tab-label { color: var(--gray-800); font-weight: 600; }
        
        /* ===== Á∏ΩË¶ΩÈ†Å ===== */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .summary-card {
            border-radius: 16px;
            padding: 18px 14px;
            text-align: center;
            transition: all 0.2s;
        }
        
        .summary-card.missing {
            border: 1.5px solid var(--red);
            background: var(--red-soft);
        }
        
        .summary-card.available { background: var(--green-soft); }
        .summary-card.memo-out { background: var(--yellow-soft); }
        .summary-card.sold { background: var(--blue-soft); }
        
        .summary-label {
            font-size: 12px;
            color: var(--gray-600);
            margin-bottom: 6px;
            font-weight: 500;
        }
        
        .summary-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--gray-800);
            letter-spacing: -0.02em;
        }
        
        .summary-card.missing .summary-value { color: var(--red); }
        .summary-card.available .summary-value { color: var(--green); }
        .summary-card.memo-out .summary-value { color: var(--yellow); }
        .summary-card.sold .summary-value { color: var(--blue); }
        
        /* ===== Áº∫Â§±Ê¨Ñ ===== */
        .missing-section {
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 16px;
            background: var(--red-soft);
            border: 1.5px solid var(--red);
        }
        
        .missing-section h3 {
            font-size: 15px;
            font-weight: 600;
            color: var(--red);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .missing-item {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 8px;
            color: var(--red);
            font-weight: 500;
            font-size: 14px;
            border: 1px solid rgba(239, 68, 68, 0.1);
        }
        
        .missing-item:last-child { margin-bottom: 0; }
        
        /* ===== Âúñ‰æã ===== */
        .legend {
            display: flex;
            gap: 16px;
            margin: 16px 0;
            padding: 14px;
            border-radius: 12px;
            font-size: 12px;
            flex-wrap: wrap;
            background: rgba(255, 255, 255, 0.4);
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .legend-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }
        
        .dot-green { background: var(--green); }
        .dot-yellow { background: var(--yellow); }
        .dot-blue { background: var(--blue); }
        .dot-gray { background: var(--gray-400); }
        .dot-red { background: var(--red); }
        
        /* ===== Á©∫ÁãÄÊÖã ===== */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--gray-500);
        }
        
        .empty-icon { font-size: 48px; margin-bottom: 12px; opacity: 0.6; }
        .empty-text { font-size: 15px; }
        
        /* ===== ËºâÂÖ•ÂãïÁï´ ===== */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(248, 250, 252, 0.9);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        
        .loading-overlay.show {
            opacity: 1;
            pointer-events: all;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--gray-200);
            border-top-color: var(--gray-800);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin-bottom: 16px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .loading-text {
            font-size: 15px;
            color: var(--gray-600);
            font-weight: 500;
        }
        
        /* ===== Ëá™ÂãïÂà∑Êñ∞ÊåáÁ§∫Âô® ===== */
        .refresh-indicator {
            position: fixed;
            top: 8px;
            left: 50%;
            transform: translateX(-50%) translateY(-40px);
            background: rgba(15, 23, 42, 0.85);
            backdrop-filter: blur(12px);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 500;
            z-index: 1500;
            transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .refresh-indicator.show {
            transform: translateX(-50%) translateY(0);
        }
        
        .refresh-indicator.spinning::before {
            content: "";
            width: 14px;
            height: 14px;
            border: 2px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
        }
        
        /* ===== Á≥ªÁµ±ÁãÄÊÖãÈù¢Êùø ===== */
        .system-status-panel {
            position: fixed;
            top: 16px;
            right: 16px;
            width: 280px;
            border-radius: 16px;
            z-index: 100;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            max-height: 48px;
        }
        
        .system-status-panel.expanded {
            max-height: 320px;
        }
        
        .status-panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 16px;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.4);
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            transition: background 0.2s;
        }
        
        .status-panel-header:hover {
            background: rgba(255, 255, 255, 0.6);
        }
        
        .status-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            font-weight: 600;
            color: var(--gray-800);
        }
        
        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--gray-400);
            transition: all 0.3s;
            position: relative;
        }
        
        .status-dot::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            border-radius: 50%;
            border: 2px solid transparent;
            transition: all 0.3s;
        }
        
        .status-dot.online {
            background: var(--green);
            box-shadow: 0 0 8px rgba(16, 185, 129, 0.5);
        }
        
        .status-dot.online::after {
            border-color: rgba(16, 185, 129, 0.3);
            animation: pulse 2s infinite;
        }
        
        .status-dot.degraded {
            background: var(--yellow);
            box-shadow: 0 0 8px rgba(245, 158, 11, 0.5);
        }
        
        .status-dot.offline {
            background: var(--red);
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
        }
        
        .status-toggle {
            font-size: 12px;
            color: var(--gray-500);
            transition: transform 0.3s;
        }
        
        .system-status-panel.expanded .status-toggle {
            transform: rotate(180deg);
        }
        
        .status-grid {
            padding: 12px;
            display: grid;
            gap: 8px;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.4);
            transition: all 0.2s;
        }
        
        .status-item:hover {
            background: rgba(255, 255, 255, 0.7);
        }
        
        .status-item.online {
            background: rgba(16, 185, 129, 0.1);
        }
        
        .status-item.degraded {
            background: rgba(245, 158, 11, 0.1);
        }
        
        .status-item.offline {
            background: rgba(239, 68, 68, 0.08);
        }
        
        .status-icon {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            flex-shrink: 0;
        }
        
        .status-info {
            flex: 1;
            min-width: 0;
        }
        
        .status-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 2px;
        }
        
        .status-detail {
            font-size: 12px;
            color: var(--gray-500);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .status-badge-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--gray-300);
            flex-shrink: 0;
        }
        
        .status-badge-indicator.online {
            background: var(--green);
            box-shadow: 0 0 6px rgba(16, 185, 129, 0.6);
        }
        
        .status-badge-indicator.degraded {
            background: var(--yellow);
            box-shadow: 0 0 6px rgba(245, 158, 11, 0.6);
        }
        
        .status-badge-indicator.offline {
            background: var(--red);
        }
        
        .status-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 16px;
            font-size: 11px;
            color: var(--gray-500);
            background: rgba(0, 0, 0, 0.02);
            border-top: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        .refresh-status-btn {
            width: 28px;
            height: 28px;
            border-radius: 8px;
            border: none;
            background: rgba(255, 255, 255, 0.6);
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .refresh-status-btn:hover {
            background: rgba(255, 255, 255, 0.9);
            transform: rotate(180deg);
        }
        
        .refresh-status-btn.spinning {
            animation: spin 1s linear infinite;
        }
        
        /* ÈüøÊáâÂºèË™øÊï¥ */
        @media (max-width: 640px) {
            .system-status-panel {
                left: 16px;
                right: 16px;
                width: auto;
                top: 50px;
            }
        }
    </style>
</head>
<body>
    <!-- Ëá™ÂãïÂà∑Êñ∞ÊåáÁ§∫Âô® -->
    <div id="refreshIndicator" class="refresh-indicator spinning">
        <span>üîÑ</span> Ê≠£Âú®ÂêåÊ≠•Êï∏Êìö...
    </div>
    
    <!-- Toast ÂÆπÂô® -->
    <div class="toast-container" id="toastContainer"></div>
    
    <!-- ===== Á≥ªÁµ±ÁãÄÊÖãÈù¢Êùø (Liquid Glass) ===== -->
    <div id="systemStatusPanel" class="system-status-panel glass-card">
        <div class="status-panel-header" onclick="toggleStatusPanel()">
            <div class="status-title">
                <span class="status-dot" id="overallStatusDot"></span>
                <span>Á≥ªÁµ±ÁãÄÊÖã</span>
            </div>
            <span class="status-toggle">‚ñº</span>
        </div>
        <div class="status-grid" id="statusGrid">
            <div class="status-item" data-service="openclaw">
                <div class="status-icon">ü§ñ</div>
                <div class="status-info">
                    <div class="status-name">OpenClaw</div>
                    <div class="status-detail" id="openclawStatus">Ê™¢Êü•‰∏≠...</div>
                </div>
                <div class="status-badge-indicator" id="openclawBadge"></div>
            </div>
            <div class="status-item" data-service="whatsapp">
                <div class="status-icon">üí¨</div>
                <div class="status-info">
                    <div class="status-name">WhatsApp</div>
                    <div class="status-detail" id="whatsappStatus">Ê™¢Êü•‰∏≠...</div>
                </div>
                <div class="status-badge-indicator" id="whatsappBadge"></div>
            </div>
            <div class="status-item" data-service="kimi">
                <div class="status-icon">üß†</div>
                <div class="status-info">
                    <div class="status-name">Kimi AI</div>
                    <div class="status-detail" id="kimiStatus">Ê™¢Êü•‰∏≠...</div>
                </div>
                <div class="status-badge-indicator" id="kimiBadge"></div>
            </div>
            <div class="status-item" data-service="qwen3">
                <div class="status-icon">‚ö°</div>
                <div class="status-info">
                    <div class="status-name">Qwen3</div>
                    <div class="status-detail" id="qwen3Status">Ê™¢Êü•‰∏≠...</div>
                </div>
                <div class="status-badge-indicator" id="qwen3Badge"></div>
            </div>
        </div>
        <div class="status-footer">
            <span id="lastStatusCheck">Êõ¥Êñ∞‰∏≠...</span>
            <button class="refresh-status-btn" onclick="manualRefreshStatus()">üîÑ</button>
        </div>
    </div>
    
    <!-- ËºâÂÖ•Ë¶ÜËìãÂ±§ -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">ËºâÂÖ•‰∏≠...</div>
    </div>

    <!-- ===== Tab 1: ÈªûË≤®ÔºàÁ∂†Ëâ≤ AvailableÔºâ ===== -->
    <div id="availableTab" class="tab-page active">
        <div class="header glass">
            <div class="header-content">
                <div>
                    <h1>ÈªûË≤®</h1>
                    <div class="last-update" id="lastUpdate">ÊúÄÂæåÊõ¥Êñ∞: ËºâÂÖ•‰∏≠...</div>
                </div>
            </div>
        </div>
        
        <div id="availableShapePage">
            <div class="import-section glass-card" onclick="importExcel()">
                <div class="import-icon">üìÅ</div>
                <div class="import-text">ÂåØÂÖ• Excel Ê∏ÖÂñÆ</div>
                <div class="import-hint">ÊîØÊè¥ .xlsx, .csv Ê†ºÂºè</div>
            </div>
            
            <h2>ÈÅ∏Êìá Shape</h2>
            <div class="shape-grid">
                <div class="shape-card glass-card" onclick="enterCheck('available', 'ALL')">
                    <div class="shape-info">
                        <h3>ALL SHAPES</h3>
                        <p id="available-count-all">0 Á≤í</p>
                    </div>
                    <div class="shape-arrow">‚Ä∫</div>
                </div>
                <div class="shape-card glass-card" onclick="enterCheck('available', 'RBC')">
                    <div class="shape-info">
                        <h3>ROUND (RBC)</h3>
                        <p id="available-count-rbc">0 Á≤í</p>
                    </div>
                    <div class="shape-arrow">‚Ä∫</div>
                </div>
                <div class="shape-card glass-card" onclick="enterCheck('available', 'EM')">
                    <div class="shape-info">
                        <h3>EMERALD (EM)</h3>
                        <p id="available-count-em">0 Á≤í</p>
                    </div>
                    <div class="shape-arrow">‚Ä∫</div>
                </div>
                <div class="shape-card glass-card" onclick="enterCheck('available', 'PR')">
                    <div class="shape-info">
                        <h3>PRINCESS (PR)</h3>
                        <p id="available-count-pr">0 Á≤í</p>
                    </div>
                    <div class="shape-arrow">‚Ä∫</div>
                </div>
            </div>
        </div>
        
        <div id="availableCheckPage" style="display: none;">
            <h2>
                <span class="back-btn" onclick="backToShapes('available')">‚Üê</span>
                <span id="availableCheckTitle">ALL SHAPES</span>
            </h2>
            
            <div class="legend glass-card">
                <div class="legend-item">
                    <div class="legend-dot dot-gray"></div>
                    <span>Êú™ÈÅ∏</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot dot-green"></div>
                    <span>ÂñÆÈªû = ÈÅ∏Âèñ Available</span>
                </div>
            </div>
            
            <div class="diamond-list" id="availableCheckList"></div>
            
            <div class="submit-bar glass">
                <div class="submit-info">
                    Â∑≤ÈÅ∏ <span id="availableSubmitCount">0</span> Á≤í
                </div>
                <button class="btn btn-secondary" onclick="resetSelection('available')">ÈáçÁΩÆ</button>
                <button class="btn btn-primary" onclick="submitSelection('available')">Êèê‰∫§</button>
            </div>
        </div>
    </div>

    <!-- ===== Tab 2: Memo OutÔºàÈªÉËâ≤Ôºâ ===== -->
    <div id="memoTab" class="tab-page">
        <div class="header glass">
            <div class="header-content">
                <div>
                    <h1>Memo Out</h1>
                    <div class="last-update">ÊúÄÂæåÊõ¥Êñ∞: ËºâÂÖ•‰∏≠...</div>
                </div>
            </div>
        </div>
        
        <div id="memoShapePage">
            <h2>ÈÅ∏Êìá Shape</h2>
            <div class="shape-grid">
                <div class="shape-card glass-card" onclick="enterCheck('memo', 'ALL')">
                    <div class="shape-info">
                        <h3>ALL SHAPES</h3>
                        <p id="memo-count-all">0 Á≤í</p>
                    </div>
                    <div class="shape-arrow">‚Ä∫</div>
                </div>
                <div class="shape-card glass-card" onclick="enterCheck('memo', 'RBC')">
                    <div class="shape-info">
                        <h3>ROUND (RBC)</h3>
                        <p id="memo-count-rbc">0 Á≤í</p>
                    </div>
                    <div class="shape-arrow">‚Ä∫</div>
                </div>
                <div class="shape-card glass-card" onclick="enterCheck('memo', 'EM')">
                    <div class="shape-info">
                        <h3>EMERALD (EM)</h3>
                        <p id="memo-count-em">0 Á≤í</p>
                    </div>
                    <div class="shape-arrow">‚Ä∫</div>
                </div>
                <div class="shape-card glass-card" onclick="enterCheck('memo', 'PR')">
                    <div class="shape-info">
                        <h3>PRINCESS (PR)</h3>
                        <p id="memo-count-pr">0 Á≤í</p>
                    </div>
                    <div class="shape-arrow">‚Ä∫</div>
                </div>
            </div>
        </div>
        
        <div id="memoCheckPage" style="display: none;">
            <h2>
                <span class="back-btn" onclick="backToShapes('memo')">‚Üê</span>
                <span id="memoCheckTitle">ALL SHAPES</span>
            </h2>
            
            <div class="legend glass-card">
                <div class="legend-item">
                    <div class="legend-dot dot-gray"></div>
                    <span>Êú™ÈÅ∏</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot dot-yellow"></div>
                    <span>ÂñÆÈªû = ÈÅ∏Âèñ Memo Out</span>
                </div>
            </div>
            
            <div class="diamond-list" id="memoCheckList"></div>
            
            <div class="submit-bar glass">
                <div class="submit-info">
                    Â∑≤ÈÅ∏ <span id="memoSubmitCount">0</span> Á≤í
                </div>
                <button class="btn btn-secondary" onclick="resetSelection('memo')">ÈáçÁΩÆ</button>
                <button class="btn btn-primary" onclick="submitSelection('memo')">Êèê‰∫§</button>
            </div>
        </div>
    </div>

    <!-- ===== Tab 3: SoldÔºàËóçËâ≤Ôºâ ===== -->
    <div id="soldTab" class="tab-page">
        <div class="header glass">
            <div class="header-content">
                <div>
                    <h1>Sold</h1>
                    <div class="last-update">ÊúÄÂæåÊõ¥Êñ∞: ËºâÂÖ•‰∏≠...</div>
                </div>
            </div>
        </div>
        
        <div id="soldShapePage">
            <h2>ÈÅ∏Êìá Shape</h2>
            <div class="shape-grid">
                <div class="shape-card glass-card" onclick="enterCheck('sold', 'ALL')">
                    <div class="shape-info">
                        <h3>ALL SHAPES</h3>
                        <p id="sold-count-all">0 Á≤í</p>
                    </div>
                    <div class="shape-arrow">‚Ä∫</div>
                </div>
                <div class="shape-card glass-card" onclick="enterCheck('sold', 'RBC')">
                    <div class="shape-info">
                        <h3>ROUND (RBC)</h3>
                        <p id="sold-count-rbc">0 Á≤í</p>
                    </div>
                    <div class="shape-arrow">‚Ä∫</div>
                </div>
                <div class="shape-card glass-card" onclick="enterCheck('sold', 'EM')">
                    <div class="shape-info">
                        <h3>EMERALD (EM)</h3>
                        <p id="sold-count-em">0 Á≤í</p>
                    </div>
                    <div class="shape-arrow">‚Ä∫</div>
                </div>
                <div class="shape-card glass-card" onclick="enterCheck('sold', 'PR')">
                    <div class="shape-info">
                        <h3>PRINCESS (PR)</h3>
                        <p id="sold-count-pr">0 Á≤í</p>
                    </div>
                    <div class="shape-arrow">‚Ä∫</div>
                </div>
            </div>
        </div>
        
        <div id="soldCheckPage" style="display: none;">
            <h2>
                <span class="back-btn" onclick="backToShapes('sold')">‚Üê</span>
                <span id="soldCheckTitle">ALL SHAPES</span>
            </h2>
            
            <div class="legend glass-card">
                <div class="legend-item">
                    <div class="legend-dot dot-gray"></div>
                    <span>Êú™ÈÅ∏</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot dot-blue"></div>
                    <span>ÂñÆÈªû = ÈÅ∏Âèñ Sold</span>
                </div>
            </div>
            
            <div class="diamond-list" id="soldCheckList"></div>
            
            <div class="submit-bar glass">
                <div class="submit-info">
                    Â∑≤ÈÅ∏ <span id="soldSubmitCount">0</span> Á≤í
                </div>
                <button class="btn btn-secondary" onclick="resetSelection('sold')">ÈáçÁΩÆ</button>
                <button class="btn btn-primary" onclick="submitSelection('sold')">Êèê‰∫§</button>
            </div>
        </div>
    </div>

    <!-- ===== Tab 4: Á∏ΩË¶Ω ===== -->
    <div id="summaryTab" class="tab-page">
        <div class="header glass">
            <div class="header-content">
                <div>
                    <h1>Áõ§ÈªûÁ∏ΩË¶Ω</h1>
                    <div class="last-update" id="summaryLastUpdate">ÊúÄÂæåÊõ¥Êñ∞: ËºâÂÖ•‰∏≠...</div>
                </div>
            </div>
        </div>
        
        <div class="summary-grid">
            <div class="summary-card glass-card">
                <div class="summary-label">Á∏ΩÊï∏</div>
                <div class="summary-value" id="totalSummary">0</div>
            </div>
            <div class="summary-card glass-card available">
                <div class="summary-label">Available</div>
                <div class="summary-value" id="availableSummary">0</div>
            </div>
            <div class="summary-card glass-card memo-out">
                <div class="summary-label">Memo Out</div>
                <div class="summary-value" id="memoOutSummary">0</div>
            </div>
            <div class="summary-card glass-card sold">
                <div class="summary-label">Sold</div>
                <div class="summary-value" id="soldSummary">0</div>
            </div>
            <div class="summary-card missing" style="grid-column: span 2;">
                <div class="summary-label">‚ùå Áº∫Â§±</div>
                <div class="summary-value" id="missingSummary">0</div>
            </div>
        </div>
        
        <div class="legend glass-card">
            <div class="legend-item"><div class="legend-dot dot-green"></div><span>Available</span></div>
            <div class="legend-item"><div class="legend-dot dot-yellow"></div><span>Memo Out</span></div>
            <div class="legend-item"><div class="legend-dot dot-blue"></div><span>Sold</span></div>
            <div class="legend-item"><div class="legend-dot dot-red"></div><span>Áº∫Â§±</span></div>
        </div>
        
        <div class="missing-section" id="missingSection">
            <h3>‚ùå Áº∫Â§±Ê∏ÖÂñÆ</h3>
            <div id="missingList"></div>
        </div>
        
        <div style="position: fixed; bottom: 90px; left: 16px; right: 16px; z-index: 50;">
            <button class="btn btn-primary" style="width: 100%; padding: 16px;" onclick="generateExcel()">
                üìä ÁîüÊàê Excel Â†±Âëä
            </button>
        </div>
    </div>

    <!-- ===== Â∫ïÈÉ® Tab Â∞éËà™ÔºàLiquid GlassÔºâ ===== -->
    <div class="tab-bar glass">
        <div class="tab-item active" onclick="switchTab('available')">
            <span class="tab-icon">‚úÖ</span>
            <span class="tab-label">ÈªûË≤®</span>
        </div>
        <div class="tab-item" onclick="switchTab('memo')">
            <span class="tab-icon">üìã</span>
            <span class="tab-label">Memo Out</span>
        </div>
        <div class="tab-item" onclick="switchTab('sold')">
            <span class="tab-icon">üí∞</span>
            <span class="tab-label">Sold</span>
        </div>
        <div class="tab-item" onclick="switchTab('summary')">
            <span class="tab-icon">üìä</span>
            <span class="tab-label">Á∏ΩË¶Ω</span>
        </div>
    </div>

    <script>
        // Mock Êï∏Êìö
        const mockData = [
            { parcel: 'EM-001', shape: 'EM', carat: 8.68, color: 'D', clarity: 'VVS2', fluor: 'Faint', price: 641625, confirmedStatus: null, selection: { available: false, memo: false, sold: false } },
            { parcel: 'EM-002', shape: 'EM', carat: 8.56, color: 'K', clarity: 'VVS2', fluor: 'None', price: 150850, confirmedStatus: null, selection: { available: false, memo: false, sold: false } },
            { parcel: 'EM-003', shape: 'EM', carat: 11.52, color: 'H', clarity: 'VVS2', fluor: 'None', price: 485200, confirmedStatus: null, selection: { available: false, memo: false, sold: false } },
            { parcel: 'EM-004', shape: 'EM', carat: 7.63, color: 'G', clarity: 'VVS2', fluor: 'None', price: 225400, confirmedStatus: null, selection: { available: false, memo: false, sold: false } },
            { parcel: 'EM-005', shape: 'EM', carat: 7.62, color: 'I', clarity: 'VVS1', fluor: 'Faint', price: 185600, confirmedStatus: null, selection: { available: false, memo: false, sold: false } },
            { parcel: 'EM-006', shape: 'EM', carat: 7.57, color: 'I', clarity: 'VVS2', fluor: 'None', price: 168400, confirmedStatus: null, selection: { available: false, memo: false, sold: false } },
            { parcel: 'RBC-001', shape: 'RBC', carat: 10.13, color: 'D', clarity: 'VVS1', fluor: 'None', price: 667481, confirmedStatus: null, selection: { available: false, memo: false, sold: false } },
            { parcel: 'RBC-002', shape: 'RBC', carat: 10.02, color: 'I', clarity: 'SI2', fluor: 'None', price: 228606, confirmedStatus: null, selection: { available: false, memo: false, sold: false } },
            { parcel: 'PR-001', shape: 'PR', carat: 5.23, color: 'G', clarity: 'VS1', fluor: 'None', price: 125000, confirmedStatus: null, selection: { available: false, memo: false, sold: false } },
            { parcel: 'PR-002', shape: 'PR', carat: 4.18, color: 'H', clarity: 'VS2', fluor: 'Faint', price: 98000, confirmedStatus: null, selection: { available: false, memo: false, sold: false } },
        ];
        
        let allData = [...mockData];
        let currentShape = { available: 'ALL', memo: 'ALL', sold: 'ALL' };
        let lastRefreshTime = null;
        
        const shapeNames = { 'ALL': 'ALL SHAPES', 'RBC': 'ROUND', 'EM': 'EMERALD', 'PR': 'PRINCESS' };
        
        const tabConfig = {
            'available': { color: 'green', label: 'Available', nextStatus: 'available' },
            'memo': { color: 'yellow', label: 'Memo Out', nextStatus: 'memo-out' },
            'sold': { color: 'blue', label: 'Sold', nextStatus: 'sold' }
        };
        
        // ===== ÂàùÂßãÂåñÔºöËá™ÂãïÂà∑Êñ∞ =====
        document.addEventListener('DOMContentLoaded', function() {
            // È°ØÁ§∫Âà∑Êñ∞ÊåáÁ§∫Âô®
            const indicator = document.getElementById('refreshIndicator');
            indicator.classList.add('show');
            
            // Ê®°Êì¨Ëá™ÂãïÂà∑Êñ∞
            setTimeout(() => {
                autoRefresh();
            }, 800);
        });
        
        // ===== Ëá™ÂãïÂà∑Êñ∞ÂäüËÉΩ =====
        function autoRefresh() {
            const indicator = document.getElementById('refreshIndicator');
            
            // Ê®°Êì¨Âà∑Êñ∞ÈÅéÁ®ã
            setTimeout(() => {
                // Êõ¥Êñ∞ÊôÇÈñì
                lastRefreshTime = new Date();
                updateLastRefreshTime();
                
                // Èö±ËóèÊåáÁ§∫Âô®
                indicator.classList.remove('show');
                
                // È°ØÁ§∫ÊàêÂäü Toast
                showToast({
                    icon: '‚úÖ',
                    title: 'Êï∏ÊìöÂ∑≤ÂêåÊ≠•',
                    message: `Â∑≤Êõ¥Êñ∞ ${allData.length} Á≤íÈëΩÁü≥Êï∏Êìö`,
                    duration: 3000
                });
                
                // ÂàùÂßãÂåñÈ°ØÁ§∫
                updateShapeCounts('available');
                updateShapeCounts('memo');
                updateShapeCounts('sold');
                
            }, 1200);
        }
        
        // ===== Êõ¥Êñ∞ÊúÄÂæåÂà∑Êñ∞ÊôÇÈñì =====
        function updateLastRefreshTime() {
            const timeStr = lastRefreshTime ? lastRefreshTime.toLocaleString('zh-HK', { 
                month: 'short', 
                day: 'numeric', 
                hour: '2-digit', 
                minute: '2-digit' 
            }) : 'ËºâÂÖ•‰∏≠...';
            
            document.querySelectorAll('.last-update').forEach(el => {
                el.textContent = `ÊúÄÂæåÊõ¥Êñ∞: ${timeStr}`;
            });
            document.getElementById('summaryLastUpdate').textContent = `ÊúÄÂæåÊõ¥Êñ∞: ${timeStr}`;
        }
        
        // ===== Toast ÈÄöÁü•Á≥ªÁµ± =====
        function showToast({ icon, title, message, duration = 4000 }) {
            const container = document.getElementById('toastContainer');
            
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.innerHTML = `
                <span class="toast-icon">${icon}</span>
                <div class="toast-content">
                    <div class="toast-title">${title}</div>
                    <div class="toast-message">${message}</div>
                </div>
                <span class="toast-close" onclick="this.parentElement.remove()">√ó</span>
            `;
            
            container.appendChild(toast);
            
            // Ëß∏ÁôºÂãïÁï´
            requestAnimationFrame(() => {
                toast.classList.add('show');
            });
            
            // Ëá™ÂãïÁßªÈô§
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 350);
            }, duration);
        }
        
        // ===== Tab ÂàáÊèõ =====
        function switchTab(tabName) {
            document.querySelectorAll('.tab-page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.tab-item').forEach(t => t.classList.remove('active'));
            
            document.getElementById(tabName + 'Tab').classList.add('active');
            
            const tabIndex = tabName === 'available' ? 0 : tabName === 'memo' ? 1 : tabName === 'sold' ? 2 : 3;
            document.querySelectorAll('.tab-item')[tabIndex].classList.add('active');
            
            if (tabName === 'summary') {
                renderSummary();
            } else {
                updateShapeCounts(tabName);
            }
        }
        
        // ===== Êõ¥Êñ∞ Shape Ë®àÊï∏ =====
        function updateShapeCounts(type) {
            const shapes = ['ALL', 'RBC', 'EM', 'PR'];
            shapes.forEach(shape => {
                const count = shape === 'ALL'
                    ? allData.filter(d => !d.confirmedStatus).length
                    : allData.filter(d => d.shape === shape && !d.confirmedStatus).length;
                const el = document.getElementById(`${type}-count-${shape.toLowerCase()}`);
                if (el) el.textContent = `${count} Á≤í`;
            });
        }
        
        // ===== ÈÄ≤ÂÖ•Áõ§ÈªûÈ†Å =====
        function enterCheck(type, shape) {
            currentShape[type] = shape;
            document.getElementById(`${type}CheckTitle`).textContent = shapeNames[shape];
            
            document.getElementById(`${type}ShapePage`).style.display = 'none';
            document.getElementById(`${type}CheckPage`).style.display = 'block';
            
            renderCheckList(type);
        }
        
        // ===== ËøîÂõû Shape È†Å =====
        function backToShapes(type) {
            document.getElementById(`${type}ShapePage`).style.display = 'block';
            document.getElementById(`${type}CheckPage`).style.display = 'none';
            updateShapeCounts(type);
        }
        
        // ===== Ê∏≤ÊüìÁõ§ÈªûÂàóË°® =====
        function renderCheckList(type) {
            const listEl = document.getElementById(`${type}CheckList`);
            const config = tabConfig[type];
            
            // Âè™È°ØÁ§∫Êú™ confirmed ÁöÑË≤®ÂìÅ
            let items = allData.filter(d => !d.confirmedStatus);
            if (currentShape[type] !== 'ALL') {
                items = items.filter(d => d.shape === currentShape[type]);
            }
            
            listEl.innerHTML = items.map((d) => {
                const isSelected = d.selection[type];
                const cardClass = isSelected ? `selected-${config.color}` : 'unchecked glass-card';
                const badge = isSelected ? `<span class="status-badge ${config.color}">Â∑≤ÈÅ∏ ${config.label}</span>` : '';
                
                return `
                    <div class="diamond-card ${cardClass}" 
                         onclick="toggleSelection('${type}', '${d.parcel}')">
                        <div class="diamond-header">
                            <div class="diamond-title">
                                ${d.shape} ${d.carat.toFixed(2)}ct
                                ${badge}
                            </div>
                            <div class="diamond-price">USD ${d.price.toLocaleString()}</div>
                        </div>
                        <div class="diamond-specs">
                            <span class="spec-tag">${d.color}</span>
                            <span class="spec-tag">${d.clarity}</span>
                            <span class="spec-tag">${d.fluor}</span>
                        </div>
                        <div class="diamond-cert">${d.parcel}</div>
                    </div>
                `;
            }).join('');
            
            // Êõ¥Êñ∞ Submit Ë®àÊï∏
            const selectedCount = allData.filter(d => d.selection[type]).length;
            document.getElementById(`${type}SubmitCount`).textContent = selectedCount;
        }
        
        // ===== ÂàáÊèõÈÅ∏ÂèñÁãÄÊÖã =====
        function toggleSelection(type, parcel) {
            const item = allData.find(d => d.parcel === parcel);
            if (!item) return;
            
            // ÂàáÊèõÈÅ∏ÂèñÁãÄÊÖã
            item.selection[type] = !item.selection[type];
            renderCheckList(type);
        }
        
        // ===== ÈáçÁΩÆÈÅ∏Âèñ =====
        function resetSelection(type) {
            const config = tabConfig[type];
            
            showToast({
                icon: 'üîÑ',
                title: 'ÈáçÁΩÆÈÅ∏Âèñ',
                message: `${shapeNames[currentShape[type]]} ÁöÑ ${config.label} ÈÅ∏ÂèñÂ∑≤ÈáçÁΩÆ`,
                duration: 2000
            });
            
            if (currentShape[type] === 'ALL') {
                allData.forEach(d => d.selection[type] = false);
            } else {
                allData.filter(d => d.shape === currentShape[type]).forEach(d => d.selection[type] = false);
            }
            renderCheckList(type);
        }
        
        // ===== Êèê‰∫§ÈÅ∏Âèñ =====
        function submitSelection(type) {
            const config = tabConfig[type];
            const selectedCount = allData.filter(d => d.selection[type]).length;
            
            if (selectedCount === 0) {
                showToast({
                    icon: '‚ö†Ô∏è',
                    title: 'Ë´ãÂÖàÈÅ∏ÂèñË≤®ÂìÅ',
                    message: 'ÈªûÊìäÈëΩÁü≥Âç°Áâá‰æÜÈÅ∏Âèñ',
                    duration: 2500
                });
                return;
            }
            
            // Â∞áÈÅ∏ÂèñÁãÄÊÖãÁ¢∫Ë™ç
            allData.forEach(d => {
                if (d.selection[type]) {
                    d.confirmedStatus = config.nextStatus;
                    d.selection[type] = false;
                }
            });
            
            showToast({
                icon: '‚úÖ',
                title: 'Êèê‰∫§ÊàêÂäü',
                message: `Â∑≤Á¢∫Ë™ç ${selectedCount} Á≤íÁÇ∫ ${config.label}`,
                duration: 3000
            });
            
            renderCheckList(type);
            updateShapeCounts(type);
        }
        
        // ===== Á∏ΩË¶ΩÈ†Å =====
        function renderSummary() {
            const total = allData.length;
            const available = allData.filter(d => d.confirmedStatus === 'available').length;
            const memoOut = allData.filter(d => d.confirmedStatus === 'memo-out').length;
            const sold = allData.filter(d => d.confirmedStatus === 'sold').length;
            const missing = allData.filter(d => !d.confirmedStatus).length;
            
            document.getElementById('totalSummary').textContent = total;
            document.getElementById('availableSummary').textContent = available;
            document.getElementById('memoOutSummary').textContent = memoOut;
            document.getElementById('soldSummary').textContent = sold;
            document.getElementById('missingSummary').textContent = missing;
            
            // Ê∏≤ÊüìÁº∫Â§±Ê∏ÖÂñÆ
            const missingItems = allData.filter(d => !d.confirmedStatus);
            const missingListEl = document.getElementById('missingList');
            const missingSectionEl = document.getElementById('missingSection');
            
            if (missingItems.length === 0) {
                missingSectionEl.style.display = 'none';
            } else {
                missingSectionEl.style.display = 'block';
                missingListEl.innerHTML = missingItems.map(d => `
                    <div class="missing-item">
                        ${d.shape} ${d.carat.toFixed(2)}ct ${d.color} ${d.clarity} - ${d.parcel}
                    </div>
                `).join('');
            }
        }
        
        // ===== ÁîüÊàê Excel =====
        function generateExcel() {
            const total = allData.length;
            const available = allData.filter(d => d.confirmedStatus === 'available').length;
            const memoOut = allData.filter(d => d.confirmedStatus === 'memo-out').length;
            const sold = allData.filter(d => d.confirmedStatus === 'sold').length;
            const missing = allData.filter(d => !d.confirmedStatus).length;
            
            let csv = 'Parcel,Shape,Carat,Color,Clarity,Fluor,Price,Status\n';
            allData.forEach(d => {
                const status = d.confirmedStatus || 'Missing';
                csv += `${d.parcel},${d.shape},${d.carat},${d.color},${d.clarity},${d.fluor},${d.price},${status}\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `Stock_Check_Report_${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
            
            showToast({
                icon: 'üìä',
                title: 'Excel Â†±ÂëäÂ∑≤ÁîüÊàê',
                message: `Á∏ΩÊï∏: ${total} | Available: ${available} | Memo Out: ${memoOut} | Sold: ${sold} | Áº∫Â§±: ${missing}`,
                duration: 4000
            });
        }
        
        // ===== ÂåØÂÖ• Excel =====
        function importExcel() {
            showToast({
                icon: 'üìÅ',
                title: 'ÂåØÂÖ•ÂäüËÉΩ',
                message: 'Ë´ãÈÅ∏Êìá Excel Êàñ CSV Êñá‰ª∂',
                duration: 3000
            });
        }
        
        // ===== Á≥ªÁµ±ÁãÄÊÖãÁõ£Êéß =====
        const STATUS_API_URL = 'http://localhost:3456/api/status';
        const STATUS_REFRESH_INTERVAL = 30000; // 30Áßí
        let statusRefreshTimer = null;
        let lastStatusData = null;
        
        // ÁãÄÊÖãÈÖçÁΩÆ
        const statusConfig = {
            openclaw: { icon: 'ü§ñ', name: 'OpenClaw' },
            whatsapp: { icon: 'üí¨', name: 'WhatsApp' },
            kimi: { icon: 'üß†', name: 'Kimi AI' },
            qwen3: { icon: '‚ö°', name: 'Qwen3' }
        };
        
        // Áç≤ÂèñÁ≥ªÁµ±ÁãÄÊÖã
        async function fetchSystemStatus() {
            try {
                const response = await fetch(STATUS_API_URL, {
                    method: 'GET',
                    headers: { 'Accept': 'application/json' },
                    // 5ÁßíË∂ÖÊôÇ
                    signal: AbortSignal.timeout ? AbortSignal.timeout(5000) : undefined
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                const data = await response.json();
                lastStatusData = data;
                updateStatusUI(data.services);
                return data;
            } catch (error) {
                console.error('Status fetch failed:', error);
                // Â¶ÇÊûúÈÄ£‰∏ç‰∏äÁãÄÊÖãÊúçÂãôÔºåÈ°ØÁ§∫Ê®°Êì¨ÁãÄÊÖã
                showSimulatedStatus();
                return null;
            }
        }
        
        // Êõ¥Êñ∞ÁãÄÊÖã UI
        function updateStatusUI(services) {
            let onlineCount = 0;
            let offlineCount = 0;
            
            Object.entries(services).forEach(([key, data]) => {
                const statusEl = document.getElementById(`${key}Status`);
                const badgeEl = document.getElementById(`${key}Badge`);
                const itemEl = document.querySelector(`[data-service="${key}"]`);
                
                if (statusEl && badgeEl && itemEl) {
                    // Êõ¥Êñ∞Ë©≥ÊÉÖÊñáÂ≠ó
                    let detailText = data.message || data.status;
                    if (data.latency) {
                        detailText += ` ¬∑ ${data.latency}ms`;
                    }
                    statusEl.textContent = detailText;
                    
                    // Êõ¥Êñ∞ÂæΩÁ´†
                    badgeEl.className = 'status-badge-indicator ' + data.status;
                    
                    // Êõ¥Êñ∞È†ÖÁõÆËÉåÊôØ
                    itemEl.className = 'status-item ' + data.status;
                    
                    // Áµ±Ë®à
                    if (data.status === 'online') onlineCount++;
                    else if (data.status === 'offline') offlineCount++;
                }
            });
            
            // Êõ¥Êñ∞Á∏ΩÈ´îÁãÄÊÖã
            const overallDot = document.getElementById('overallStatusDot');
            if (overallDot) {
                if (onlineCount === 4) {
                    overallDot.className = 'status-dot online';
                } else if (offlineCount > 0) {
                    overallDot.className = 'status-dot offline';
                } else {
                    overallDot.className = 'status-dot degraded';
                }
            }
            
            // Êõ¥Êñ∞ÊúÄÂæåÊ™¢Êü•ÊôÇÈñì
            const lastCheckEl = document.getElementById('lastStatusCheck');
            if (lastCheckEl && services.openclaw?.lastCheck) {
                const date = new Date(services.openclaw.lastCheck);
                lastCheckEl.textContent = `Êõ¥Êñ∞Êñº ${date.toLocaleTimeString('zh-HK', { hour: '2-digit', minute: '2-digit' })}`;
            }
        }
        
        // È°ØÁ§∫Ê®°Êì¨ÁãÄÊÖãÔºàÁï∂ÁãÄÊÖãÊúçÂãô‰∏çÂèØÁî®Êó∂Ôºâ
        function showSimulatedStatus() {
            const simulatedData = {
                openclaw: { status: 'online', message: 'Running (Demo)' },
                whatsapp: { status: 'online', message: 'Connected (Demo)' },
                kimi: { status: 'online', message: 'API Ready (Demo)' },
                qwen3: { status: 'degraded', message: 'Local Mode (Demo)' }
            };
            updateStatusUI(simulatedData);
            
            document.getElementById('lastStatusCheck').textContent = 'Demo Mode';
        }
        
        // ÂàáÊèõÁãÄÊÖãÈù¢Êùø
        function toggleStatusPanel() {
            const panel = document.getElementById('systemStatusPanel');
            panel.classList.toggle('expanded');
        }
        
        // ÊâãÂãïÂà∑Êñ∞ÁãÄÊÖã
        async function manualRefreshStatus() {
            const btn = document.querySelector('.refresh-status-btn');
            btn.classList.add('spinning');
            
            await fetchSystemStatus();
            
            setTimeout(() => {
                btn.classList.remove('spinning');
            }, 500);
            
            showToast({
                icon: 'üîÑ',
                title: 'ÁãÄÊÖãÂ∑≤Êõ¥Êñ∞',
                message: 'Á≥ªÁµ±ÁãÄÊÖãÊ™¢Êü•ÂÆåÊàê',
                duration: 2000
            });
        }
        
        // ÂïüÂãïÁãÄÊÖãÁõ£Êéß
        function startStatusMonitoring() {
            // Á´ãÂç≥Áç≤Âèñ‰∏ÄÊ¨°
            fetchSystemStatus();
            
            // ÂÆöÊúüÂà∑Êñ∞
            statusRefreshTimer = setInterval(fetchSystemStatus, STATUS_REFRESH_INTERVAL);
        }
        
        // ÂÅúÊ≠¢ÁãÄÊÖãÁõ£Êéß
        function stopStatusMonitoring() {
            if (statusRefreshTimer) {
                clearInterval(statusRefreshTimer);
                statusRefreshTimer = null;
            }
        }
        
        // È†ÅÈù¢ÂèØË¶ãÊÄßËÆäÂåñÊôÇËôïÁêÜ
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                stopStatusMonitoring();
            } else {
                startStatusMonitoring();
                fetchSystemStatus(); // Á´ãÂç≥Âà∑Êñ∞
            }
        });
        
        // ÂàùÂßãÂåñÊôÇÂïüÂãïÁãÄÊÖãÁõ£Êéß
        startStatusMonitoring();
    </script>
</body>
</html>